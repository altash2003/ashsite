<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNT Profile</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&family=Russo+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #110022;
            --card-purple: #2e1065;
            --accent-yellow: #fbbf24;
            --text-white: #ffffff;
            --sidebar-width-collapsed: 80px;
            --sidebar-width-expanded: 260px;
        }
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Outfit', sans-serif; }
        body { background-color: var(--bg-dark); color: white; display:flex; height:100vh; overflow:hidden; }

        /* --- SIDEBAR (Hover Effect) --- */
        .sidebar { 
            width: var(--sidebar-width-collapsed); 
            background: rgba(15, 23, 42, 0.6); 
            border-right: 1px solid rgba(255,255,255,0.1); 
            display: flex; flex-direction: column; 
            padding-top: 20px; 
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .sidebar:hover {
            width: var(--sidebar-width-expanded);
        }

        /* Sidebar Logo Area */
        .brand {
            display: flex; align-items: center; gap: 15px;
            padding: 0 20px; margin-bottom: 30px;
            height: 50px;
            white-space: nowrap;
        }
        .brand-logo { 
            min-width: 40px; height: 40px; 
            background: #6366f1; border-radius: 10px; 
            display: grid; place-items: center; font-family: 'Russo One'; font-size: 1.2rem; 
        }
        .brand-text {
            font-family: 'Russo One'; font-size: 1.2rem; color: #fbbf24;
            opacity: 0; transition: opacity 0.2s;
        }
        .sidebar:hover .brand-text { opacity: 1; transition-delay: 0.1s; }

        /* Navigation Items */
        .nav-item { 
            display: flex; align-items: center; 
            padding: 12px 20px; margin-bottom: 5px; 
            cursor: pointer; position: relative;
            color: #94a3b8; transition: 0.2s;
            white-space: nowrap;
        }
        
        .nav-item:hover, .nav-item.active { 
            background: rgba(99, 102, 241, 0.1); 
            color: #fff; 
        }
        .nav-item.active::before {
            content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px; background: #6366f1;
            box-shadow: 0 0 10px #6366f1;
        }

        .nav-icon { 
            font-size: 1.3rem; 
            min-width: 40px; 
            display: grid; place-items: center; 
        }
        
        .nav-label { 
            margin-left: 15px; font-weight: 600; font-size: 1rem; 
            opacity: 0; transform: translateX(-10px); transition: 0.2s;
        }
        
        .sidebar:hover .nav-label { 
            opacity: 1; transform: translateX(0); 
        }

        /* --- MAIN CONTENT --- */
        .main { flex:1; padding:40px; overflow-y:auto; background: radial-gradient(circle at top right, #4c1d95 0%, #110022 60%); }
        .hidden { display:none !important; }

        /* --- PROFILE CARD --- */
        .profile-container {
            background: #2e1065;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .header-title { font-family: 'Russo One'; font-size: 2.5rem; margin-bottom: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .badges { display:flex; gap:10px; margin-bottom:30px; }
        .badge { padding: 5px 15px; border-radius:8px; font-weight:800; font-size:0.8rem; text-transform:uppercase; display:flex; align-items:center; gap:5px; letter-spacing:1px; }
        .badge-staff { background: #6366f1; box-shadow: 0 0 15px rgba(99,102,241,0.5); }
        .badge-million { background: #fbbf24; color:black; box-shadow: 0 0 15px rgba(251,191,36,0.5); border:1px solid white; }
        .badge-radiant { background: linear-gradient(90deg, #06b6d4, #d946ef); box-shadow: 0 0 15px #d946ef; }
        
        .currency-row { display:flex; align-items:center; gap:15px; margin-bottom:15px; font-family:'Russo One'; font-size:1.5rem; }
        .icon-coin { color:#fbbf24; font-size:1.8rem; filter:drop-shadow(0 0 5px #fbbf24); }
        .icon-gem { color:#d8b4fe; font-size:1.8rem; filter:drop-shadow(0 0 5px #d8b4fe); }

        .avatar-circle {
            position: absolute; right: 50px; top: 50%; transform: translateY(-50%);
            width: 200px; height: 200px; border-radius: 50%;
            border: 5px solid #6366f1;
            background: #0f172a;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(99,102,241,0.4);
        }
        .avatar-circle img { width:100%; height:100%; object-fit:cover; }

        .footer-icons { position:absolute; bottom:30px; right:50px; display:flex; gap:15px; font-size:1.5rem; }
        .f-icon { cursor:pointer; opacity:0.7; transition:0.2s; }
        .f-icon:hover { opacity:1; transform:scale(1.1); }

        /* --- DAILY REWARD MODAL --- */
        .modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:99; display:flex; justify-content:center; align-items:center; backdrop-filter:blur(5px); display:none; }
        .modal-overlay.open { display:flex; }
        
        .reward-box { width: 900px; border-radius: 20px; overflow: hidden; border: 4px solid #fbbf24; box-shadow: 0 20px 50px rgba(0,0,0,0.8); }
        .rew-header { background: #fbbf24; padding: 15px; text-align: center; position: relative; border-bottom: 5px solid #d97706; }
        .rew-title { font-family: 'Russo One'; font-size: 2.5rem; color: #1e1b4b; text-transform: uppercase; margin:0; }
        .close-btn { position:absolute; right:20px; top:20px; background:#ef4444; color:white; font-weight:bold; border:2px solid white; border-radius:8px; width:35px; height:35px; cursor:pointer; }
        
        .rew-body { background: #a855f7; padding: 40px 20px; display:flex; flex-direction:column; align-items:center; }
        .days-row { display:flex; gap:10px; justify-content:center; align-items:flex-end; width:100%; margin-bottom:30px; }
        
        .day-card {
            width: 100px; height: 140px;
            border-radius: 10px; border: 2px solid rgba(255,255,255,0.6);
            /* Purple Sunburst */
            background: repeating-conic-gradient(from 0deg, #7c3aed 0deg 15deg, #6d28d9 15deg 30deg);
            display: flex; flex-direction:column; align-items:center; justify-content:space-between; padding:10px;
            color: white; text-align:center;
            position: relative;
        }
        .day-card.claimed::after { content:'Claimed'; position:absolute; top:35%; font-weight:bold; font-size:0.9rem; text-shadow:0 0 5px black; }
        .day-card.claimed { filter: brightness(0.7); }

        .day-card.active {
            width: 120px; height: 160px;
            border: 3px solid white;
            /* Yellow Sunburst */
            background: repeating-conic-gradient(from 0deg, #fbbf24 0deg 15deg, #d97706 15deg 30deg);
            color: #451a03; transform:translateY(-10px); z-index:10;
            box-shadow: 0 0 30px #fbbf24;
        }
        .day-amt { font-family:'Russo One'; font-size:1.1rem; line-height:1.1; }

        .claim-btn {
            background: #fbbf24; border:none; padding: 15px 80px; border-radius:50px;
            font-family:'Russo One'; font-size:1.5rem; color: #451a03;
            box-shadow: 0 6px 0 #b45309, 0 15px 20px rgba(0,0,0,0.3);
            cursor:pointer; transition:0.1s;
        }
        .claim-btn:active { transform:translateY(6px); box-shadow:0 0 0 #b45309; }
        .claim-btn:disabled { background:gray; box-shadow:none; cursor:default; }

        /* GRID STYLES FOR STORE/AUCTION */
        .grid-cards { display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:20px; margin-top:20px; }
        .g-card { background: #1e1b4b; padding:15px; border-radius:12px; border:1px solid rgba(255,255,255,0.1); }
        .g-btn { width:100%; padding:10px; margin-top:10px; background:#6366f1; border:none; color:white; font-weight:bold; border-radius:6px; cursor:pointer; }
        
        /* NEWS STYLES */
        .news-item { background: rgba(0,0,0,0.3); border-radius: 12px; margin-bottom: 15px; overflow: hidden; display: flex; border: 1px solid rgba(255,255,255,0.1); }
        .news-img { width: 150px; height: 100px; object-fit: cover; }
        .news-content { padding: 15px; flex: 1; }
        .news-date { color: #fbbf24; font-size: 0.8rem; font-weight: bold; margin-bottom: 5px; }
        .news-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="brand">
            <div class="brand-logo">S</div>
            <div class="brand-text">SNT</div>
        </div>

        <div class="nav-item active" onclick="switchTab('home', this)">
            <div class="nav-icon"><i class="fas fa-home"></i></div>
            <div class="nav-label">Dashboard</div>
        </div>

        <div class="nav-item" onclick="switchTab('news', this)">
            <div class="nav-icon"><i class="fas fa-bullhorn"></i></div>
            <div class="nav-label">Announcements</div>
        </div>

        <div class="nav-item" onclick="switchTab('store', this)">
            <div class="nav-icon"><i class="fas fa-store"></i></div>
            <div class="nav-label">Item Store</div>
        </div>

        <div class="nav-item" onclick="switchTab('auction', this)">
            <div class="nav-icon"><i class="fas fa-gavel"></i></div>
            <div class="nav-label">Auction House</div>
        </div>

        <div class="nav-item" onclick="switchTab('casino', this)">
            <div class="nav-icon"><i class="fas fa-dice"></i></div>
            <div class="nav-label">Casino Royale</div>
        </div>

        <div class="nav-item" onclick="switchTab('inventory', this)">
            <div class="nav-icon"><i class="fas fa-box"></i></div>
            <div class="nav-label">Inventory</div>
        </div>
    </div>

    <div class="main">
        <div id="tab-home">
            <h1 class="header-title">Welcome Back, <span id="u-name">...</span></h1>
            
            <div class="profile-container">
                <div style="width: 60%;">
                    <h2 style="font-family:'Russo One'; margin-bottom:15px;">Player Profile</h2>
                    
                    <div class="badges" id="u-badges">
                        </div>

                    <div class="currency-row"><i class="fas fa-coins icon-coin"></i> <span id="u-credits">0</span> <span style="font-size:1rem; opacity:0.7; margin-left:5px">Credits</span></div>
                    <div class="currency-row"><i class="fas fa-gem icon-gem"></i> <span id="u-crystals">0</span> <span style="font-size:1rem; opacity:0.7; margin-left:5px">Crystals</span></div>

                    <div style="margin-top:30px;">
                        <input type="text" id="code-in" placeholder="Enter Giftcode" style="padding:10px; border-radius:8px; border:none; background:rgba(0,0,0,0.3); color:white;">
                        <button onclick="redeem()" style="padding:10px 20px; border-radius:8px; border:none; background:#10b981; color:white; font-weight:bold; cursor:pointer;">Redeem</button>
                        <span id="redeem-msg" style="margin-left:10px; font-weight:bold;"></span>
                    </div>
                </div>

                <div class="avatar-circle"><img src="https://ui-avatars.com/api/?name=ST&background=0D8ABC&color=fff&size=256" alt="Avatar"></div>
                
                <div class="footer-icons">
                    <div class="f-icon" style="color:#fbbf24" onclick="openRewards()"><i class="fas fa-gift"></i></div>
                    <div class="f-icon" style="color:#1877f2"><i class="fab fa-facebook"></i></div>
                    <div class="f-icon" style="color:#5865f2"><i class="fab fa-discord"></i></div>
                </div>
            </div>
            
            <h2 style="margin-top: 40px; margin-bottom: 20px;">Featured Event</h2>
            <div class="g-card" style="display: flex; align-items: center; gap: 20px;">
                <div style="font-size: 3rem; color: #fbbf24; padding: 0 20px;"><i class="fas fa-trophy"></i></div>
                <div>
                    <h3>High Stakes Tournament</h3>
                    <p style="opacity: 0.7;">Join the Auction House to bid on exclusive tickets!</p>
                </div>
                <button class="g-btn" style="width: auto; margin-left: auto; padding: 10px 30px;" onclick="switchTab('auction', document.querySelectorAll('.nav-item')[4])">Go Now</button>
            </div>
        </div>

        <div id="tab-news" class="hidden">
            <h1 class="header-title">Announcements</h1>
            <div id="news-container"></div>
        </div>

        <div id="tab-store" class="hidden">
            <h1 class="header-title">Item Store</h1>
            <div class="grid-cards" id="store-grid"></div>
        </div>

        <div id="tab-auction" class="hidden">
            <h1 class="header-title">Auction House</h1>
            <div class="grid-cards" id="auc-grid"></div>
        </div>

        <div id="tab-casino" class="hidden">
            <h1 class="header-title">Casino Royale</h1>
            <div class="grid-cards">
                <div class="g-card" style="text-align: center; padding: 40px;">
                    <i class="fas fa-dice" style="font-size: 3rem; color: #d946ef; margin-bottom: 20px;"></i>
                    <h3>Neon Slots</h3>
                    <p style="margin-bottom: 20px; opacity: 0.7;">Spin to win the jackpot!</p>
                    <button class="g-btn">Play Now</button>
                </div>
                <div class="g-card" style="text-align: center; padding: 40px;">
                    <i class="fas fa-chess-king" style="font-size: 3rem; color: #fbbf24; margin-bottom: 20px;"></i>
                    <h3>High Roller Poker</h3>
                    <p style="margin-bottom: 20px; opacity: 0.7;">Tables open for VIPs.</p>
                    <button class="g-btn">Join Table</button>
                </div>
            </div>
        </div>

        <div id="tab-inventory" class="hidden">
            <h1 class="header-title">My Inventory</h1>
            <div class="grid-cards" id="inv-grid"></div>
        </div>
    </div>

    <div id="rewards-modal" class="modal-overlay">
        <div class="reward-box">
            <div class="rew-header">
                <h2 class="rew-title">Daily Reward</h2>
                <p style="color:#451a03; font-weight:700;">Come back every day to get better rewards!</p>
                <button class="close-btn" onclick="document.getElementById('rewards-modal').classList.remove('open')">X</button>
            </div>
            <div class="rew-body">
                <div class="days-row">
                    <div class="day-card claimed"><div>Day 1</div><div class="day-amt">100<br>Coins</div></div>
                    <div class="day-card claimed"><div>Day 2</div><div class="day-amt">500<br>Coins</div></div>
                    <div class="day-card claimed"><div>Day 3</div><div class="day-amt">1K<br>Coins</div></div>
                    <div class="day-card active"><div>Day 4</div><div class="day-amt">5K<br>Coins</div></div>
                    <div class="day-card"><div>Day 5</div><div class="day-amt">10K<br>Coins</div></div>
                    <div class="day-card"><div>Day 6</div><div class="day-amt">50K<br>Coins</div></div>
                    <div class="day-card"><div>Day 7</div><div class="day-amt">100K<br>Coins</div></div>
                </div>
                <button class="claim-btn" id="btn-claim" onclick="claimDaily()">CLAIM</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myUser = null;

        // Auto Login for Demo
        socket.emit('player:login', 'tussday');

        socket.on('player:login_success', u => { myUser = u; render(); });
        socket.on('sync:full_data', db => {
            if(myUser) myUser = db.players.find(p => p.id === myUser.id) || myUser;
            render(db);
        });
        socket.on('redeem_success', msg => { document.getElementById('redeem-msg').innerText = msg; document.getElementById('redeem-msg').style.color = '#4ade80'; });
        socket.on('redeem_fail', msg => { document.getElementById('redeem-msg').innerText = msg; document.getElementById('redeem-msg').style.color = '#f87171'; });

        function render(db) {
            if(!myUser) return;
            
            // PROFILE
            document.getElementById('u-name').innerText = myUser.user;
            document.getElementById('u-credits').innerText = myUser.credits.toLocaleString();
            document.getElementById('u-crystals').innerText = myUser.crystals.toLocaleString();
            
            const badgeCont = document.getElementById('u-badges');
            badgeCont.innerHTML = '';
            if(myUser.badges.includes('STAFF')) badgeCont.innerHTML += `<div class="badge badge-staff"><i class="fas fa-shield-alt"></i> STAFF</div>`;
            if(myUser.badges.includes('MILLIONAIRE')) badgeCont.innerHTML += `<div class="badge badge-million"><i class="fas fa-crown"></i> MILLIONAIRE</div>`;
            if(myUser.badges.includes('RADIANT')) badgeCont.innerHTML += `<div class="badge badge-radiant"><i class="fas fa-gem"></i> RADIANT</div>`;

            // INVENTORY
            const inv = document.getElementById('inv-grid');
            inv.innerHTML = '';
            if(myUser.inventory.length === 0) inv.innerHTML = '<p style="opacity:0.5">Your inventory is empty.</p>';
            myUser.inventory.forEach(i => {
                inv.innerHTML += `<div class="g-card" style="text-align:center"><img src="${i.img}" style="width:80px; height:80px; object-fit:cover; margin-bottom:10px;"><div>${i.name}</div></div>`;
            });

            if(db) {
                // ANNOUNCEMENTS
                const newsCont = document.getElementById('news-container');
                newsCont.innerHTML = '';
                if(db.announcements.length === 0) newsCont.innerHTML = '<p style="opacity:0.5">No announcements yet.</p>';
                db.announcements.forEach(n => {
                    newsCont.innerHTML += `
                    <div class="news-item">
                        <img src="${n.img}" class="news-img">
                        <div class="news-content">
                            <div class="news-date">${new Date(n.id).toLocaleDateString()}</div>
                            <div class="news-title">${n.title}</div>
                            <div style="font-size:0.9rem; opacity:0.8;">${n.content.substring(0, 100)}...</div>
                        </div>
                    </div>`;
                });

                // STORE
                const st = document.getElementById('store-grid'); st.innerHTML = '';
                db.storeItems.forEach(i => {
                    if(i.status === 'Available')
                    st.innerHTML += `<div class="g-card"><img src="${i.img}" style="width:100%; height:120px; object-fit:cover; margin-bottom:10px;"><h3>${i.name}</h3><div style="color:#fbbf24">${i.price} Credits</div><button class="g-btn" onclick="socket.emit('player:buy_item', {userId:${myUser.id}, itemId:${i.id}})">Buy</button></div>`;
                });

                // AUCTIONS
                const au = document.getElementById('auc-grid'); au.innerHTML = '';
                db.auctions.forEach(a => {
                    if(a.status === 'Active') {
                        const min = parseInt(a.bid) + 100;
                        au.innerHTML += `<div class="g-card"><img src="${a.img}" style="width:100%; height:120px; object-fit:cover; margin-bottom:10px;"><h3>${a.item}</h3><div style="color:#fbbf24">Bid: ${a.bid}</div><div style="font-size:0.8rem">Bidder: ${a.bidder||'None'}</div><button class="g-btn" onclick="socket.emit('player:place_bid', {userId:${myUser.id}, aucId:${a.id}, bid:${min}})">Bid ${min}</button></div>`;
                    }
                });
            }
        }

        function switchTab(t, el) {
            document.querySelectorAll('.main > div').forEach(d => d.classList.add('hidden'));
            document.getElementById('tab-'+t).classList.remove('hidden');
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            // Add active class to clicked item (if passed)
            if(el) el.classList.add('active');
        }

        function openRewards() { document.getElementById('rewards-modal').classList.add('open'); }
        function claimDaily() {
            socket.emit('player:claim_daily', { userId: myUser.id, day:4, amount:5000 });
            document.getElementById('btn-claim').innerText = 'CLAIMED!';
            document.getElementById('btn-claim').disabled = true;
            document.getElementById('btn-claim').style.background = 'gray';
            setTimeout(() => document.getElementById('rewards-modal').classList.remove('open'), 1000);
        }
        function redeem() {
            const code = document.getElementById('code-in').value;
            socket.emit('player:redeem_code', { userId: myUser.id, code });
        }
    </script>
</body>
</html>
