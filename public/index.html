<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNT Dashboard</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Sora:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* DARK GAMER PALETTE */
            --bg-app: #121214;         
            --bg-panel: #1e1e24;       
            --bg-panel-hover: #2a2a32; 
            --accent-primary: #6366f1; /* Purple */
            --accent-glow: rgba(99, 102, 241, 0.4);
            --accent-secondary: #fbbf24; /* Yellow */
            --text-main: #ffffff;
            --text-muted: #a1a1aa;
            --radius-lg: 30px;         
            --radius-sm: 15px;
        }

        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Inter', sans-serif; }
        
        body { 
            background-color: var(--bg-app); 
            color: var(--text-main); 
            height: 100vh; 
            display: flex; 
            padding: 20px; 
            gap: 20px;
            overflow: hidden;
        }

        /* --- 1. SIDEBAR (Left Strip) --- */
        .sidebar {
            width: 80px;
            background: var(--bg-panel);
            border-radius: var(--radius-lg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 0;
            flex-shrink: 0;
            box-shadow: 5px 0 20px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .brand-logo {
            width: 50px; height: 50px;
            background: var(--accent-primary);
            color: white;
            border-radius: 15px;
            display: grid; place-items: center;
            font-family: 'Sora', sans-serif; font-weight: 800; font-size: 1.5rem;
            margin-bottom: 40px;
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .nav-item {
            width: 50px; height: 50px;
            border-radius: 15px;
            display: grid; place-items: center;
            color: var(--text-muted);
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .nav-item:hover { background: var(--bg-panel-hover); color: white; }
        .nav-item.active { 
            background: var(--accent-primary); 
            color: white; 
            box-shadow: 0 5px 15px var(--accent-glow);
        }
        
        .nav-item::after {
            content: attr(data-tooltip);
            position: absolute; left: 70px;
            background: white; color: black;
            padding: 5px 10px; border-radius: 6px;
            font-size: 0.8rem; font-weight: 600;
            opacity: 0; pointer-events: none;
            transition: 0.2s; white-space: nowrap;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 101;
        }
        .nav-item:hover::after { opacity: 1; transform: translateX(5px); }


        /* --- 2. MAIN DASHBOARD AREA --- */
        .app-container {
            flex: 1;
            background: var(--bg-app);
            border-radius: var(--radius-lg);
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow: hidden;
            position: relative;
        }

        /* TOP HEADER */
        .top-bar {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px 10px;
        }

        .search-pill {
            background: var(--bg-panel);
            padding: 12px 25px;
            border-radius: 50px;
            display: flex; align-items: center; gap: 10px;
            width: 400px;
            color: var(--text-muted);
        }
        .search-pill input {
            background: transparent; border: none; color: white; outline: none; width: 100%; font-family: 'Inter';
        }

        .user-actions { display: flex; align-items: center; gap: 20px; }
        .icon-btn { 
            width: 45px; height: 45px; 
            border-radius: 50%; 
            background: var(--bg-panel); 
            display: grid; place-items: center; 
            cursor: pointer; position: relative;
        }
        .icon-btn.has-notif::after {
            content: ''; position: absolute; top: 10px; right: 10px; width: 8px; height: 8px; background: #ef4444; border-radius: 50%; border: 2px solid var(--bg-panel);
        }
        .profile-mini {
            display: flex; align-items: center; gap: 10px;
            background: var(--bg-panel); padding: 5px 15px 5px 5px;
            border-radius: 50px; cursor: pointer;
        }
        .profile-mini img { width: 35px; height: 35px; border-radius: 50%; }


        /* DASHBOARD CONTENT GRID */
        .dashboard-content {
            flex: 1;
            display: grid;
            grid-template-columns: 2.5fr 1fr; /* Main Feed vs Right Sidebar */
            gap: 20px;
            overflow-y: auto;
            padding-right: 10px;
        }

        /* --- LEFT COLUMN --- */
        .feed-column { display: flex; flex-direction: column; gap: 25px; }

        /* HERO BANNER */
        .hero-banner {
            height: 300px;
            border-radius: var(--radius-lg);
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.8)), url('https://placehold.co/800x400/2e1065/FFF?text=Stick+N+Trade');
            background-size: cover; background-position: center;
            position: relative;
            padding: 40px;
            display: flex; flex-direction: column; justify-content: flex-end;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .hero-content h1 { font-family: 'Sora'; font-size: 3rem; margin-bottom: 10px; line-height: 1.1; }
        .hero-content p { color: var(--text-muted); max-width: 60%; margin-bottom: 20px; }
        .hero-stats { display: flex; gap: 20px; }
        .stat-badge {
            background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
            padding: 10px 20px; border-radius: 15px;
            display: flex; align-items: center; gap: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* CARDS */
        .sec-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .sec-title { font-family: 'Sora'; font-size: 1.2rem; font-weight: 700; }
        
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }

        .gamer-card {
            background: var(--bg-panel);
            border-radius: var(--radius-sm);
            padding: 15px;
            transition: 0.3s;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .gamer-card:hover { transform: translateY(-5px); background: var(--bg-panel-hover); border-color: var(--accent-primary); }
        .card-img { width: 100%; height: 120px; border-radius: 10px; object-fit: cover; margin-bottom: 15px; }
        .card-title { font-family: 'Sora'; font-weight: 600; font-size: 1rem; margin-bottom: 5px; }
        .card-meta { font-size: 0.8rem; color: var(--text-muted); display: flex; justify-content: space-between; align-items: center; }


        /* --- RIGHT COLUMN --- */
        .sidebar-right {
            display: flex; flex-direction: column; gap: 25px;
        }

        .mini-section {
            background: var(--bg-panel);
            border-radius: var(--radius-lg);
            padding: 25px;
        }

        .list-item {
            display: flex; align-items: center; gap: 15px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .list-thumb { width: 40px; height: 40px; border-radius: 10px; object-fit: cover; }
        .list-info h4 { font-family: 'Sora'; font-size: 0.9rem; }
        .list-info span { font-size: 0.75rem; color: var(--text-muted); }

        /* REDEEM WIDGET */
        .redeem-widget {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
            border: 1px solid var(--accent-primary);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
        }
        .redeem-input {
            width: 100%; padding: 12px;
            border-radius: 10px; border: none;
            background: rgba(0,0,0,0.3); color: white;
            margin: 15px 0; outline: none;
            font-family: 'Inter';
        }
        .redeem-btn {
            width: 100%; padding: 10px;
            background: var(--accent-primary);
            color: white; border: none; border-radius: 10px;
            font-family: 'Sora'; font-weight: 700; cursor: pointer;
        }

        /* UTILS */
        .view-section { display: none; animation: fadeIn 0.4s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* REWARD MODAL */
        .modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:999; display:flex; justify-content:center; align-items:center; backdrop-filter:blur(5px); display:none; }
        .modal-overlay.open { display:flex; }
        .reward-box { width: 800px; border-radius: 20px; overflow: hidden; border: 4px solid #fbbf24; box-shadow: 0 20px 50px rgba(0,0,0,0.8); }
        .rew-body { background: #a855f7; padding: 30px; display:flex; flex-direction:column; align-items:center; }
        .days-row { display:flex; gap:10px; justify-content:center; align-items:flex-end; width:100%; margin-bottom:30px; }
        .day-card { width: 90px; height: 120px; border-radius: 10px; background: #7c3aed; text-align: center; display: flex; flex-direction: column; justify-content: center; position: relative; border: 2px solid rgba(255,255,255,0.3); }
        .day-card.active { width: 110px; height: 140px; background: #fbbf24; color: black; z-index: 10; border: 3px solid white; box-shadow: 0 0 30px #fbbf24; }
        .claim-btn { background: #fbbf24; border:none; padding: 15px 60px; border-radius:50px; font-family:'Sora'; font-weight: 800; font-size:1.3rem; color: #451a03; cursor:pointer; }

    </style>
</head>
<body>

    <div class="sidebar">
        <div class="brand-logo">S</div>
        <div class="nav-item active" onclick="switchView('home', this)" data-tooltip="Dashboard"><i class="fas fa-home"></i></div>
        <div class="nav-item" onclick="switchView('announcements', this)" data-tooltip="News"><i class="fas fa-bullhorn"></i></div>
        <div class="nav-item" onclick="switchView('store', this)" data-tooltip="Store"><i class="fas fa-store"></i></div>
        <div class="nav-item" onclick="switchView('auction', this)" data-tooltip="Auctions"><i class="fas fa-gavel"></i></div>
        <div class="nav-item" onclick="switchView('casino', this)" data-tooltip="Casino"><i class="fas fa-dice"></i></div>
        <div class="nav-item" onclick="switchView('inventory', this)" data-tooltip="Inventory"><i class="fas fa-box"></i></div>
    </div>

    <div class="app-container">
        
        <div class="top-bar">
            <div class="search-pill">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search anything...">
            </div>
            <div class="user-actions">
                <div class="icon-btn has-notif"><i class="fas fa-bell"></i></div>
                <div class="profile-mini">
                    <img src="https://ui-avatars.com/api/?name=User&background=6366f1&color=fff" id="mini-avatar">
                    <span style="font-size:0.9rem; font-weight:600; margin-right:10px;" id="u-name-mini">Player</span>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            
            <div class="feed-column">
                
                <div id="view-home" class="view-section active">
                    <div class="hero-banner">
                        <div class="hero-content">
                            <h1>Welcome Back,<br><span id="u-name-hero" style="color:var(--accent-secondary)">Player</span></h1>
                            <p>Check your latest stats and daily rewards.</p>
                            <div class="hero-stats">
                                <div class="stat-badge"><i class="fas fa-coins" style="color:#fbbf24"></i> <span id="u-credits">0</span> Credits</div>
                                <div class="stat-badge"><i class="fas fa-gem" style="color:#d8b4fe"></i> <span id="u-crystals">0</span> Crystals</div>
                                <div class="stat-badge" style="background:var(--accent-primary); cursor:pointer;" onclick="openRewards()">Daily Reward</div>
                            </div>
                        </div>
                    </div>

                    <div class="sec-header" style="margin-top:30px;">
                        <div class="sec-title">Quick Actions</div>
                    </div>
                    <div class="card-grid">
                        <div class="gamer-card" onclick="switchView('store', document.querySelectorAll('.nav-item')[2])">
                            <img src="https://placehold.co/300x150/1e1b4b/FFF?text=Store" class="card-img">
                            <div class="card-title">Item Store</div>
                            <div class="card-meta"><span>New items available</span><i class="fas fa-arrow-right"></i></div>
                        </div>
                        <div class="gamer-card" onclick="switchView('auction', document.querySelectorAll('.nav-item')[3])">
                            <img src="https://placehold.co/300x150/312e81/FFF?text=Auctions" class="card-img">
                            <div class="card-title">Auction House</div>
                            <div class="card-meta"><span>Live Bidding</span><i class="fas fa-arrow-right"></i></div>
                        </div>
                        <div class="gamer-card" onclick="switchView('casino', document.querySelectorAll('.nav-item')[4])">
                            <img src="https://placehold.co/300x150/4c1d95/FFF?text=Casino" class="card-img">
                            <div class="card-title">Casino Royale</div>
                            <div class="card-meta"><span>High Stakes</span><i class="fas fa-arrow-right"></i></div>
                        </div>
                    </div>
                </div>

                <div id="view-store" class="view-section">
                    <h2 class="sec-title" style="font-size:2rem; margin-bottom:20px;">Item Store</h2>
                    <div class="card-grid" id="store-grid"></div>
                </div>

                <div id="view-auction" class="view-section">
                    <h2 class="sec-title" style="font-size:2rem; margin-bottom:20px;">Auction House</h2>
                    <div class="card-grid" id="auc-grid"></div>
                </div>

                <div id="view-announcements" class="view-section">
                    <h2 class="sec-title" style="font-size:2rem; margin-bottom:20px;">Announcements</h2>
                    <div id="news-container"></div>
                </div>

                 <div id="view-casino" class="view-section">
                    <h2 class="sec-title" style="font-size:2rem; margin-bottom:20px;">Casino Royale</h2>
                    <div class="card-grid">
                        <div class="gamer-card" style="text-align:center; padding:30px;">
                            <i class="fas fa-dice" style="font-size:4rem; color:#fbbf24; margin-bottom:20px;"></i>
                            <h3>Slots</h3>
                            <button style="width:100%; padding:10px; background:var(--accent-primary); border:none; border-radius:10px; color:white; margin-top:15px; cursor:pointer;">Play</button>
                        </div>
                        <div class="gamer-card" style="text-align:center; padding:30px;">
                            <i class="fas fa-chess-board" style="font-size:4rem; color:#ec4899; margin-bottom:20px;"></i>
                            <h3>Roulette</h3>
                            <button style="width:100%; padding:10px; background:var(--accent-primary); border:none; border-radius:10px; color:white; margin-top:15px; cursor:pointer;">Play</button>
                        </div>
                    </div>
                </div>

                <div id="view-inventory" class="view-section">
                    <h2 class="sec-title" style="font-size:2rem; margin-bottom:20px;">My Inventory</h2>
                    <div class="card-grid" id="inv-grid-main"></div>
                </div>

            </div>

            <div class="sidebar-right">
                
                <div class="redeem-widget">
                    <i class="fas fa-gift" style="font-size:2rem; color:var(--accent-secondary); margin-bottom:10px;"></i>
                    <h3 style="font-family:'Sora'; margin-bottom:5px;">Redeem Code</h3>
                    <p style="font-size:0.8rem; color:var(--text-muted);">Have a gift code? Enter it below.</p>
                    <input type="text" id="code-in" class="redeem-input" placeholder="SNT-XXXX">
                    <button class="redeem-btn" onclick="redeem()">Redeem</button>
                    <p id="redeem-msg" style="margin-top:10px; font-size:0.8rem;"></p>
                </div>

                <div class="mini-section">
                    <div class="sec-header">
                        <div class="sec-title">My Library</div>
                        <span class="see-all" onclick="switchView('inventory', document.querySelectorAll('.nav-item')[5])">All</span>
                    </div>
                    <div id="mini-inv-list">
                        <p style="color:var(--text-muted); font-size:0.9rem;">Loading...</p>
                    </div>
                </div>

                <div class="mini-section">
                    <div class="sec-header">
                        <div class="sec-title">Live Updates</div>
                    </div>
                    <div id="live-feed-list">
                        <div class="list-item">
                            <div class="list-thumb" style="background:#10b981; display:grid; place-items:center;"><i class="fas fa-gavel"></i></div>
                            <div class="list-info"><h4>New Bid</h4><span>Dragon Sword</span></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="rewards-modal" class="modal-overlay">
        <div class="reward-box">
            <div style="background:#fbbf24; padding:15px; display:flex; justify-content:space-between; align-items:center;">
                <h2 style="font-family:'Sora'; color:#1e1b4b; text-transform:uppercase; margin:0;">Daily Reward</h2>
                <button onclick="document.getElementById('rewards-modal').classList.remove('open')" style="background:#ef4444; color:white; border:2px solid white; border-radius:6px; width:30px; cursor:pointer;">X</button>
            </div>
            <div class="rew-body">
                <div class="days-row">
                    <div class="day-card claimed"><div>Day 1</div><div>100</div></div>
                    <div class="day-card claimed"><div>Day 2</div><div>500</div></div>
                    <div class="day-card claimed"><div>Day 3</div><div>1K</div></div>
                    <div class="day-card active"><div>Day 4</div><div style="font-size:1.2rem; font-weight:800">5K</div></div>
                    <div class="day-card"><div>Day 5</div><div>10K</div></div>
                </div>
                <button class="claim-btn" id="btn-claim" onclick="claimDaily()">CLAIM REWARD</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myUser = null;

        socket.emit('player:login', 'tussday');

        socket.on('player:login_success', u => { myUser = u; render(null); });
        socket.on('sync:full_data', db => {
            if(myUser) myUser = db.players.find(p => p.id === myUser.id) || myUser;
            render(db);
        });
        socket.on('redeem_success', msg => { document.getElementById('redeem-msg').innerText = msg; document.getElementById('redeem-msg').style.color = '#10b981'; });
        socket.on('redeem_fail', msg => { document.getElementById('redeem-msg').innerText = msg; document.getElementById('redeem-msg').style.color = '#ef4444'; });

        function render(db) {
            if(!myUser) return;
            
            document.getElementById('u-name-mini').innerText = myUser.user;
            document.getElementById('u-name-hero').innerText = myUser.user;
            document.getElementById('u-credits').innerText = myUser.credits.toLocaleString();
            document.getElementById('u-crystals').innerText = myUser.crystals.toLocaleString();

            const miniInv = document.getElementById('mini-inv-list');
            miniInv.innerHTML = '';
            if(myUser.inventory.length === 0) miniInv.innerHTML = '<span style="color:var(--text-muted); font-size:0.8rem;">Empty</span>';
            myUser.inventory.slice(0, 4).forEach(i => {
                miniInv.innerHTML += `<div class="list-item"><img src="${i.img}" class="list-thumb"><div class="list-info"><h4>${i.name}</h4><span>Item</span></div></div>`;
            });

            const mainInv = document.getElementById('inv-grid-main');
            mainInv.innerHTML = '';
            myUser.inventory.forEach(i => {
                mainInv.innerHTML += `<div class="gamer-card"><img src="${i.img}" class="card-img"><div class="card-title">${i.name}</div><div class="card-meta"><span>Owned</span></div></div>`;
            });

            if(db) {
                const st = document.getElementById('store-grid'); st.innerHTML = '';
                db.storeItems.forEach(i => {
                    if(i.status === 'Available')
                    st.innerHTML += `<div class="gamer-card"><img src="${i.img}" class="card-img"><div class="card-title">${i.name}</div><div class="card-meta"><span style="color:#fbbf24">${i.price} Credits</span></div><button style="width:100%; margin-top:10px; padding:8px; background:var(--accent-primary); border:none; border-radius:6px; color:white; cursor:pointer;" onclick="socket.emit('player:buy_item', {userId:${myUser.id}, itemId:${i.id}})">Buy</button></div>`;
                });

                const au = document.getElementById('auc-grid'); au.innerHTML = '';
                db.auctions.forEach(a => {
                    if(a.status === 'Active') {
                        const min = parseInt(a.bid) + 100;
                        au.innerHTML += `<div class="gamer-card"><img src="${a.img}" class="card-img"><div class="card-title">${a.item}</div><div class="card-meta"><span style="color:#fbbf24">Bid: ${a.bid}</span></div><button style="width:100%; margin-top:10px; padding:8px; background:var(--bg-panel-hover); border:1px solid white; border-radius:6px; color:white; cursor:pointer;" onclick="socket.emit('player:place_bid', {userId:${myUser.id}, aucId:${a.id}, bid:${min}})">Bid ${min}</button></div>`;
                    }
                });

                const news = document.getElementById('news-container'); news.innerHTML = '';
                db.announcements.forEach(n => {
                    news.innerHTML += `<div class="gamer-card" style="cursor:default;"><div class="card-meta"><span>${new Date(n.id).toLocaleDateString()}</span></div><div class="card-title" style="font-size:1.2rem; margin:10px 0;">${n.title}</div><p style="color:var(--text-muted); font-size:0.9rem;">${n.content}</p></div>`;
                });
            }
        }

        function switchView(viewId, el) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.getElementById('view-'+viewId).classList.add('active');
            if(el) { document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); el.classList.add('active'); }
        }

        function openRewards() { document.getElementById('rewards-modal').classList.add('open'); }
        function claimDaily() {
            socket.emit('player:claim_daily', { userId: myUser.id, day:4, amount:5000 });
            document.getElementById('btn-claim').innerText = 'CLAIMED!';
            document.getElementById('btn-claim').disabled = true;
            setTimeout(() => document.getElementById('rewards-modal').classList.remove('open'), 1000);
        }
        function redeem() {
            const code = document.getElementById('code-in').value;
            socket.emit('player:redeem_code', { userId: myUser.id, code });
        }
    </script>
</body>
</html>
